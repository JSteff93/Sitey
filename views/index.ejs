<!DOCTYPE html>
<html lang="en">
<%- include("header.ejs") %>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<body>
    <div class="container">
        <% if (locals.projects) { %>
            <% projects.forEach(project => { %>
                <div class="projcont">
                    <h2>
                        <%= project.name %>
                    </h2>
                    <div class="taskcont">
                        <ul>
                            <% tasks.forEach(task => { %>
                                <% if (task.section_id === null) { %>
                                    <% if (task.project_id === project.id) { %>
                                        <li>
                                            <%= task.content %>
                                        </li>
                                    <% } %>
                                <% } %>
                            <% }) %>
                        </ul>
                        <% sections.forEach(section => { %>
                            <% if (section.project_id === project.id) { %>
                                <h3>
                                    <%= section.name %>
                                </h3>
                                <ul>
                                <% tasks.forEach(task => { %>
                                    <% if (task.section_id === section.id) { %>
                                        <li>
                                            <%= task.content %>
                                        </li>
                                    <% } %>
                                <% }) %>
                                </ul>
                            <% } %>
                        <% }) %>
                    </div>
                </div>
            <% }) %>
        <% } %>
    </div>
    <script>
        $('.projcont').click(function() {
            $(this).find('.taskcont').slideToggle();
        })
    </script>
</body>
</html>